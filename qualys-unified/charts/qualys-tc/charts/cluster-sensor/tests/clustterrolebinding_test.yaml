suite: Test Qualys clusterrolebinding creation
values:
  - ../values.yaml
templates:
  - clustersensor-clusterrolebinding.yaml
tests:
  - it: Should pass all kinds of assertions for clusterrolebinding
    set:
      global:
        namespace: qualys
    asserts:
      - hasDocuments:
          count: 1
      - isKind:
          of: ClusterRoleBinding
      - equal:
          path: apiVersion
          value: "rbac.authorization.k8s.io/v1"
      - equal:
          path: metadata.name
          value: qualys-clustersensor-cluster-reader-rb
      - equal:
          path: subjects[0].kind
          value: ServiceAccount
      - equal:
          path: subjects[0].name
          value: qualys-clustersensor-sa
      - equal:
          path: subjects[0].namespace
          value: NAMESPACE
      - equal:
          path: roleRef.kind
          value: ClusterRole
      - equal:
          path: roleRef.name
          value: qualys-clustersensor-cluster-reader-role 
      - equal:
          path: roleRef.apiGroup
          value: "rbac.authorization.k8s.io"
